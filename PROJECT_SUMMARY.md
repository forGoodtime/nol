# üìã AIinDrive - –§–∏–Ω–∞–ª—å–Ω–∞—è —Å–≤–æ–¥–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞

## ‚úÖ –ß—Ç–æ —Å–æ–∑–¥–∞–Ω–æ

### üèóÔ∏è –û—Å–Ω–æ–≤–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞
- **–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞** - –ø–æ–ª–Ω–∞—è –º–æ–¥—É–ª—å–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ MVP
- **–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞** - YAML –∫–æ–Ω—Ñ–∏–≥–∏ –¥–ª—è —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤
- **–ú–æ–¥—É–ª—å–Ω—ã–π –¥–∏–∑–∞–π–Ω** - —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –Ω–∞ datasets, models, losses, trainers
- **Docker –ø–æ–¥–¥–µ—Ä–∂–∫–∞** - –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –¥–ª—è –æ–±—É—á–µ–Ω–∏—è –∏ –∏–Ω—Ñ–µ—Ä–µ–Ω—Å–∞

### üß† –ö–ª—é—á–µ–≤—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

#### üìä –î–∞–Ω–Ω—ã–µ –∏ –ø—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∞
- `src/datasets/` - –∑–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö, –∞—É–≥–º–µ–Ω—Ç–∞—Ü–∏–∏, COCO –ø–æ–¥–¥–µ—Ä–∂–∫–∞
- `src/utils/shadow_removal.py` - –±–æ—Ä—å–±–∞ —Å —Ç–µ–Ω—è–º–∏ –∏ –±–ª–∏–∫–∞–º–∏
- `scripts/prepare_data.py` - –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∏ –≤–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö
- `notebooks/eda.ipynb` - –∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑ –¥–∞–Ω–Ω—ã—Ö

#### üéØ –ò–Ω–Ω–æ–≤–∞—Ü–∏–æ–Ω–Ω—ã–µ loss —Ñ—É–Ω–∫—Ü–∏–∏
- `src/losses/knout_pryanik_loss.py` - "–∫–Ω—É—Ç –∏ –ø—Ä—è–Ω–∏–∫" –º–µ—Ö–∞–Ω–∏–∑–º
- –ê–¥–∞–ø—Ç–∏–≤–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ —Å –ø–æ–æ—â—Ä–µ–Ω–∏–µ–º/–Ω–∞–∫–∞–∑–∞–Ω–∏–µ–º
- –£—Å–∏–ª–µ–Ω–Ω–æ–µ –≤–Ω–∏–º–∞–Ω–∏–µ –∫ –∫—Ä–∏—Ç–∏—á–Ω—ã–º –∫–ª–∞—Å—Å–∞–º
- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–æ–≤

#### üîç –ò–Ω—Ñ–µ—Ä–µ–Ω—Å —Å–∏—Å—Ç–µ–º–∞
- `src/inference/infer.py` - –ø–æ–ª–Ω—ã–π pipeline –æ–±—Ä–∞–±–æ—Ç–∫–∏
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ single image –∏ batch processing
- –ì–µ–Ω–µ—Ä–∞—Ü–∏—è heatmap –∏ overlay –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–π
- JSON API –¥–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–æ–º

#### ‚öôÔ∏è –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
- `src/config/default.yaml` - –±–∞–∑–æ–≤–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
- `src/config/train_small.yaml` - –±—ã—Å—Ç—Ä–æ–µ –æ–±—É—á–µ–Ω–∏–µ –Ω–∞ –º–∞–ª—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- `src/config/augment.yaml` - —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∞—É–≥–º–µ–Ω—Ç–∞—Ü–∏–∏

### üõ†Ô∏è –ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞

#### üê≥ Docker
- `docker/Dockerfile.train` - –æ–±—É—á–µ–Ω–∏–µ —Å GPU
- `docker/Dockerfile.infer` - –ª–µ–≥–∫–∏–π –∏–Ω—Ñ–µ—Ä–µ–Ω—Å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
- `docker/requirements-inference.txt` - –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

#### üìù –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
- `README.md` - –ø–æ–ª–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ —Å –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è–º–∏
- `QUICKSTART.md` - –ø–æ—à–∞–≥–æ–≤–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ
- `data/README.md` - –ø—Ä–∞–≤–∏–ª–∞ —Ä–∞–∑–º–µ—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö
- –í—Å—Ç—Ä–æ–µ–Ω–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –≤ –∫–æ–¥–µ

#### üß™ –î–µ–º–æ –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
- `simple_demo.py` - –¥–µ–º–æ –±–µ–∑ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
- `demo.py` - –ø–æ–ª–Ω—ã–π –¥–µ–º–æ —Å –≥–µ–Ω–µ—Ä–∞—Ü–∏–µ–π –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
- `scripts/evaluate.sh` - –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –æ—Ü–µ–Ω–∫–∞
- –ü—Ä–∏–º–µ—Ä —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –≤ `demo_results/`

## üéØ –ö–ª—é—á–µ–≤—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏

### 1. üé≠ –ú–µ—Ö–∞–Ω–∏–∑–º "–ö–Ω—É—Ç –∏ –ø—Ä—è–Ω–∏–∫"
```python
# –ü—Ä—è–Ω–∏–∫: —Å–Ω–∏–∂–µ–Ω–∏–µ loss –ø—Ä–∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–º –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–∏
if prediction == target:
    loss = base_loss * (1.0 - reward_factor)

# –ö–Ω—É—Ç: —É–≤–µ–ª–∏—á–µ–Ω–∏–µ loss –ø—Ä–∏ –æ—à–∏–±–∫–µ  
else:
    loss = base_loss * (1.0 + penalty_factor)
    
# –£—Å–∏–ª–µ–Ω–Ω—ã–π –∫–Ω—É—Ç –¥–ª—è –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö –∫–ª–∞—Å—Å–æ–≤
if target_class == 3:  # —Å–µ—Ä—å–µ–∑–Ω—ã–µ –ø–æ–≤—Ä–µ–∂–¥–µ–Ω–∏—è
    loss = loss * critical_multiplier
```

### 2. üåì –ë–æ—Ä—å–±–∞ —Å —Ç–µ–Ω—è–º–∏ –∏ –±–ª–∏–∫–∞–º–∏
- CLAHE (Contrast Limited Adaptive Histogram Equalization)
- –ú–æ—Ä—Ñ–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏
- –ö–æ—Ä—Ä–µ–∫—Ü–∏—è –±–∞–ª–∞–Ω—Å–∞ –±–µ–ª–æ–≥–æ
- –î–µ—Ç–µ–∫—Ü–∏—è –∏ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è "—Ç–µ–Ω—å vs –¥–µ—Ñ–µ–∫—Ç"

### 3. üìä 4-—É—Ä–æ–≤–Ω–µ–≤–∞—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è
- **0**: –ù–µ—Ç –ø–æ–≤—Ä–µ–∂–¥–µ–Ω–∏–π (–∑–µ–ª–µ–Ω—ã–π)
- **1**: –õ–µ–≥–∫–∏–µ –ø–æ–≤—Ä–µ–∂–¥–µ–Ω–∏—è (–∂–µ–ª—Ç—ã–π) - —Ü–∞—Ä–∞–ø–∏–Ω—ã, –≥—Ä—è–∑—å  
- **2**: –£–º–µ—Ä–µ–Ω–Ω—ã–µ –ø–æ–≤—Ä–µ–∂–¥–µ–Ω–∏—è (–æ—Ä–∞–Ω–∂–µ–≤—ã–π) - –≤–º—è—Ç–∏–Ω—ã, –∫–æ—Ä—Ä–æ–∑–∏—è
- **3**: –°–µ—Ä—å–µ–∑–Ω—ã–µ –ø–æ–≤—Ä–µ–∂–¥–µ–Ω–∏—è (–∫—Ä–∞—Å–Ω—ã–π) - –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –¥–µ—Ç–∞–ª–µ–π

### 4. üîó Multi-task –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞
- –ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è —Å—Ç–µ–ø–µ–Ω–∏ –ø–æ–≤—Ä–µ–∂–¥–µ–Ω–∏—è (0-3)
- –°–µ–≥–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ–≤—Ä–µ–∂–¥–µ–Ω–Ω—ã—Ö –æ–±–ª–∞—Å—Ç–µ–π
- Anomaly detection –¥–ª—è –Ω–µ—Ä–∞–∑–º–µ—á–µ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- Fusion head: RGB + heatmap ‚Üí final prediction

## üìà Workflow –æ–±—É—á–µ–Ω–∏—è

1. **üîç EDA** ‚Üí `jupyter lab notebooks/eda.ipynb`
2. **‚öñÔ∏è Baseline** ‚Üí `python src/trainers/trainer_classification.py --config src/config/train_small.yaml`
3. **üéØ –°–µ–≥–º–µ–Ω—Ç–∞—Ü–∏—è** ‚Üí U-Net/Mask R-CNN –∏–ª–∏ PatchCore/PaDiM
4. **üîó Joint training** ‚Üí –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è + —Å–µ–≥–º–µ–Ω—Ç–∞—Ü–∏—è
5. **üé≠ –ö–Ω—É—Ç –∏ –ø—Ä—è–Ω–∏–∫** ‚Üí –∞–¥–∞–ø—Ç–∏–≤–Ω–∞—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è
6. **üß™ –í–∞–ª–∏–¥–∞—Ü–∏—è** ‚Üí `./scripts/evaluate.sh`

## üöÄ –ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∫ –¥–µ–ø–ª–æ—é

### ‚úÖ MVP –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
- [x] –ü–æ–ª–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞
- [x] –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞  
- [x] –ú–æ–¥—É–ª–∏ –ø—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∏
- [x] –ö–∞—Å—Ç–æ–º–Ω—ã–µ loss —Ñ—É–Ω–∫—Ü–∏–∏
- [x] –ò–Ω—Ñ–µ—Ä–µ–Ω—Å pipeline
- [x] Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏—è
- [x] –î–µ–º–æ —Å–∏—Å—Ç–µ–º–∞
- [x] –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

### üîÑ –¢—Ä–µ–±—É–µ—Ç –¥–∞–Ω–Ω—ã—Ö
- [ ] –û–±—É—á–µ–Ω–∏–µ baseline –º–æ–¥–µ–ª–∏
- [ ] –í–∞–ª–∏–¥–∞—Ü–∏—è –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- [ ] –¢—é–Ω–∏–Ω–≥ –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
- [ ] A/B —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### üéØ –†–∞—Å—à–∏—Ä–µ–Ω–∏—è
- [ ] WebUI –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
- [ ] FastAPI —Å–µ—Ä–≤–µ—Ä  
- [ ] –ú–æ–±–∏–ª—å–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
- [ ] –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è

## üéâ –†–µ–∑—É–ª—å—Ç–∞—Ç

**–°–æ–∑–¥–∞–Ω–∞ –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω–∞—è MVP —Å–∏—Å—Ç–µ–º–∞** –¥–ª—è –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –ø–æ–≤—Ä–µ–∂–¥–µ–Ω–∏–π –∞–≤—Ç–æ–º–æ–±–∏–ª–µ–π:

1. **üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞** - –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–∞—è, –º–æ–¥—É–ª—å–Ω–∞—è
2. **üí° –ò–Ω–Ω–æ–≤–∞—Ü–∏–∏** - "–∫–Ω—É—Ç –∏ –ø—Ä—è–Ω–∏–∫", –±–æ—Ä—å–±–∞ —Å —Ç–µ–Ω—è–º–∏
3. **üì¶ –ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å** - Docker, –∫–æ–Ω—Ñ–∏–≥–∏, –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
4. **üöÄ –°–∫–æ—Ä–æ—Å—Ç—å** - –±—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç, –¥–µ–º–æ, –ø—Ä–∏–º–µ—Ä—ã
5. **üë• –ö–æ–º–∞–Ω–¥–∞** - —Ä–∞—Å—Å—á–∏—Ç–∞–Ω–æ –Ω–∞ 2 ML-–∏–Ω–∂–µ–Ω–µ—Ä–æ–≤

## üîß –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

```bash
# 1. –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ —É—Å—Ç–∞–Ω–æ–≤–∫–∞
git clone <repo> && cd AIinDrive
conda env create -f environment.yml && conda activate aiindrive

# 2. –î–µ–º–æ –∑–∞–ø—É—Å–∫
python simple_demo.py

# 3. –° —Ä–µ–∞–ª—å–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏
python scripts/prepare_data.py --action organize --source-dir /path/to/images
jupyter lab notebooks/eda.ipynb
python src/trainers/trainer_classification.py --config src/config/default.yaml

# 4. –ò–Ω—Ñ–µ—Ä–µ–Ω—Å
python src/inference/infer.py --input image.jpg --model model.pt --output results/
```

## üí™ –ì–æ—Ç–æ–≤–æ –∫ —Ö–∞–∫–∞—Ç–æ–Ω—É!

–°–∏—Å—Ç–µ–º–∞ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç:
- ‚úÖ **–í–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º–æ—Å—Ç—å** - —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ seeds, Docker
- ‚úÖ **–ö–∞—á–µ—Å—Ç–≤–æ** - –º–µ—Ç—Ä–∏–∫–∏, –≤–∞–ª–∏–¥–∞—Ü–∏—è, —Ç–µ—Å—Ç—ã  
- ‚úÖ **–°–∫–æ—Ä–æ—Å—Ç—å —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏** - –≥–æ—Ç–æ–≤—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã, –¥–µ–º–æ
- ‚úÖ **–ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å** - –º–æ–¥—É–ª—å–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞
- ‚úÖ **–ò–Ω–Ω–æ–≤–∞—Ü–∏–∏** - —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ –ø–æ–¥—Ö–æ–¥—ã –∫ –æ–±—É—á–µ–Ω–∏—é

---

**üèÜ –ü—Ä–æ–µ–∫—Ç –≥–æ—Ç–æ–≤ –∫ –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏ –∏ –¥–∞–ª—å–Ω–µ–π—à–µ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ!**
